---
layout: default
title: March Madness Example
nav_order: 3
---
# March Madness Simulation

This example is a sports ranking simulation based on the 1998 undergraduate thesis of Kenneth Massey. The application uses historical game data and linear algebra to predict the placement of teams in the NCAA basketball tournament. The application takes 2 parameters, the additional points added to teams playing home and weighting games based on margin of points. The experiment will vary these parameters and assess its effect on the accuracy of the simulated team ranking.

## Repository

My GitHub repository contains two Jupyter Notebooks, my environment.yml file, a Data folder that has all the data my project needs, and an includes directory which stores libraries and files my project uses.

![](https://github.com/phesse001/march_madness_jupyter/blob/gh-pages/images/sample-repo.PNG?raw=true)

### Evironment.yml

Here is a look at the environment.yml file I used to create the environment for programming C++ in Jupyter Notebooks

![](https://github.com/phesse001/march_madness_jupyter/blob/gh-pages/images/my_yml.PNG?raw=true)

## Building the Image at mybinder.org

With the repository set up, now we just have to give binder the url to our GitHub repository.

![](https://github.com/phesse001/march_madness_jupyter/blob/gh-pages/images/binder-step1.PNG?raw=true)

## What You See Post Build

Once Binder finishes building your image you will eventually be redirected to a page that looks like this

![](https://github.com/phesse001/march_madness_jupyter/blob/gh-pages/images/post_build.PNG?raw=true)

As you can see, everything from the GitHub repository is now in this running Docker image created by Binder

## Test for Notbook

{"cells":[{"metadata":{"trusted":true},"cell_type":"code","source":"#pragma cling add_include_path(\"/home/jovyan/include_files/\")\n#include \"Game.cpp\"\n#include \"Simulator.cpp\"\n#include \"Team.cpp\"","execution_count":1,"outputs":[]},{"metadata":{},"cell_type":"markdown","source":"# Parameters\n## Home Field Advantage\nHome field advandtage is used to account for the fact that the home team is generally at an advantage over the away team. For example, if Duke beat Gonzaga by 2 points and Gonzaga was the home team, a home field advantage of 4 would cause Gonzaga to take the win by 2 points.\n## Scale Large Margins\nScale large margins is used to account for large score margins negatively affecting rankings. When a highly ranked team defeats a low ranked team, the higher ranked team will usually put in back up players and play conservatively, so even if they win, their rating will almost always go down, and the opposite is true for the lower ranked team. To compensate for this, games with win margins >= 21 will be scaled down to have less effect on the rankings.\n"},{"metadata":{"trusted":true},"cell_type":"code","source":"#include \"xwidgets/xslider.hpp\"\nxw::slider<int> slider;\nslider.min = 0;\nslider.max = 15;\nslider.value = 0;\nslider.description = \"Home Field Advantage\";\nslider.display();\n\n#include \"xwidgets/xcheckbox.hpp\"\nxw::checkbox checkbox;\ncheckbox.value = false;\ncheckbox.description = \"Scale Large Margins?\";\ncheckbox.indent = false;\ncheckbox.display();","execution_count":2,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"21322c261b2749b68106343f2d500975","version_major":2,"version_minor":0},"text/plain":"A Jupyter widget"},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"be20ef3c1e3f4fb1a7f363efb280cac9","version_major":2,"version_minor":0},"text/plain":"A Jupyter widget"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"int home_field_advantage = slider.value;\nbool apply_scaling = checkbox.value;","execution_count":3,"outputs":[]},{"metadata":{},"cell_type":"markdown","source":"## Results"},{"metadata":{"trusted":true},"cell_type":"code","source":"run(home_field_advantage, apply_scaling);","execution_count":4,"outputs":[{"output_type":"stream","text":"104 Gonzaga\n75 Duke\n329 Virginia\n205 North Carolina\n295 Texas Tech\n169 Michigan St\n114 Houston\n137 Kentucky\n289 Tennessee\n330 Virginia Tech\n17 Auburn\n236 Purdue\n168 Michigan\n353 Youngstown St\n195 Nevada\n32 Buffalo\n348 Wofford\n92 Florida St\n153 LSU\n198 New Mexico St\n149 Louisville\n320 Utah St\n326 VCU\n184 Murray St\n192 NC State\n172 Mississippi St\n127 Iowa St\n133 Kansas\n143 Lipscomb\n346 Wisconsin\n21 Belmont\n47 Cincinnati\n222 Oregon\n158 Marquette\n308 UCF\n49 Clemson\n279 St Mary's CA\n160 Maryland\n327 Vermont\n328 Villanova\n246 S Dakota St\n292 Texas\n285 Syracuse\n89 Florida\n337 Washington\n67 Dayton\n134 Kansas St\n95 Furman\n112 Hofstra\n164 Memphis\n218 Oklahoma\n94 Fresno St\n126 Iowa\n305 UC Irvine\n297 Toledo\n142 Liberty\n217 Ohio St\n253 San Francisco\n171 Mississippi\n20 Baylor\n194 Nebraska\n188 N Kentucky\n60 Creighton\n287 TCU\n123 Indiana\n14 Arkansas\n54 Colorado\n352 Yale\n11 Arizona St\n177 Montana\n66 Davidson\n226 Penn St\n83 ETSU\n209 Northeastern\n349 Wright St\n288 Temple\n166 Miami FL\n321 Utah Valley\n343 Wichita St\n10 Arizona\n261 Seton Hall\n316 USC\n52 Col Charleston\n152 Loyola-Chicago\n106 Grand Canyon\n131 Jacksonville St\n313 UNC Greensboro\n4 Alabama\n229 Pittsburgh\n53 Colgate\n34 BYU\n170 Minnesota\n223 Oregon St\n269 South Florida\n97 Ga Southern\n251 San Diego\n3 Akron\n351 Xavier\n220 Old Dominion\n278 St Louis\n273 St Bonaventure\n33 Butler\n309 UCLA\n57 Connecticut\n31 Bucknell\n235 Providence\n212 Northwestern\n252 San Diego St\n276 St John's\n18 Austin Peay\n27 Bowling Green\n73 Drake\n214 Notre Dame\n267 South Carolina\n283 Stony Brook\n281 Stanford\n238 Radford\n173 Missouri\n19 Ball St\n24 Boise St\n103 Georgia Tech\n265 SMU\n35 C Michigan\n293 Texas A&M\n319 Utah\n294 Texas St\n100 Georgetown\n109 Harvard\n225 Penn\n270 Southern Miss\n347 WKU\n102 Georgia St\n244 Rutgers\n1 Abilene Chr\n25 Boston College\n148 Louisiana Tech\n150 Loy Marymount\n301 Tulsa\n239 Rhode Island\n120 Illinois\n310 ULM\n71 DePaul\n307 UC Santa Barbara\n250 Samford\n247 S Illinois\n29 Brown\n187 N Illinois\n99 George Mason\n315 UNLV\n185 N Colorado\n303 UAB\n141 Lehigh\n208 North Texas\n136 Kent\n318 UT San Antonio\n110 Hawaii\n98 Gardner Webb\n76 Duquesne\n43 Charleston So\n51 Coastal Car\n108 Hartford\n302 TX Southern\n101 Georgia\n219 Oklahoma St\n260 Seattle\n193 NE Omaha\n249 Sam Houston St\n339 Weber St\n340 West Virginia\n28 Bradley\n242 Rider\n159 Marshall\n233 Presbyterian\n125 Iona\n227 Pepperdine\n128 IUPUI\n85 F Dickinson\n8 American Univ\n107 Hampton\n232 Prairie View\n215 Oakland\n323 UTRGV\n202 NJIT\n341 WI Green_Bay\n167 Miami OH\n345 Winthrop\n175 Missouri St\n55 Colorado St\n317 UT Arlington\n87 FL Atlantic\n228 PFW\n119 IL Chicago\n186 N Dakota St\n147 Louisiana\n39 Campbell\n277 St Joseph's PA\n241 Richmond\n140 Lamar\n211 Northern Iowa\n237 Quinnipiac\n325 Vanderbilt\n197 New Mexico\n36 Cal Baptist\n79 E Michigan\n311 UMBC\n248 Sacred Heart\n207 North Florida\n62 CS Fullerton\n121 Illinois St\n203 Norfolk St\n144 LIU Brooklyn\n344 William & Mary\n161 Massachusetts\n80 E Washington\n234 Princeton\n263 Siena\n113 Holy Cross\n105 Grambling\n275 St Francis PA\n165 Mercer\n26 Boston Univ\n178 Montana St\n336 Wake Forest\n124 Indiana St\n268 South Dakota\n243 Robert Morris\n88 FL Gulf Coast\n56 Columbia\n12 Ark Little Rock\n266 South Alabama\n91 Florida Intl\n93 Fordham\n111 High Point\n216 Ohio\n65 Dartmouth\n154 MA_Lowell\n255 Santa Clara\n61 CS Bakersfield\n324 Valparaiso\n9 Appalachian St\n145 Long Beach St\n224 Pacific\n64 CS Sacramento\n258 SE Louisiana\n84 Evansville\n138 La Salle\n16 Army\n157 Marist\n274 St Francis NY\n40 Canisius\n272 Southern Utah\n338 Washington St\n191 NC Central\n63 CS Northridge\n231 Portland St\n2 Air Force\n199 New Orleans\n284 SUNY Albany\n240 Rice\n304 UC Davis\n74 Drexel\n59 Cornell\n86 Fairfield\n72 Detroit\n68 Delaware\n299 Troy\n190 NC A&T\n174 Missouri KC\n183 MTSU\n286 TAM C. Christi\n50 Cleveland St\n115 Houston Bap\n206 North Dakota\n298 Towson\n146 Longwood\n130 Jacksonville\n15 ArkansasSt\n179 Morehead St\n314 UNC Wilmington\n151 Loyola MD\n200 Niagara\n342 WI Milwaukee\n176 Monmouth NJ\n210 Northern Arizona\n132 James Madison\n78 E Kentucky\n96 G Washington\n38 California\n334 W Michigan\n189 Navy\n335 Wagner\n116 Howard\n280 St Peter's\n322 UTEP\n22 Bethune-Cookman\n262 SF Austin\n81 East Carolina\n139 Lafayette\n156 Manhattan\n333 W Illinois\n221 Oral Roberts\n201 Nicholls St\n129 Jackson St\n44 Charlotte\n48 Citadel\n13 Ark Pine Bluff\n45 Chattanooga\n41 Cent Arkansas\n118 Idaho St\n6 Alabama St\n300 Tulane\n296 TN Martin\n42 Central Conn\n82 Elon\n77 E Illinois\n259 SE Missouri St\n204 North Alabama\n70 Denver\n332 W Carolina\n290 Tennessee St\n182 Mt St Mary's\n30 Bryant\n90 Florida A&M\n180 Morgan St\n306 UC Riverside\n23 Binghamton\n350 Wyoming\n162 McNeese St\n331 VMI\n271 Southern Univ\n230 Portland\n245 S Carolina St\n264 SIUE\n155 Maine\n291 Tennessee Tech\n37 Cal Poly\n282 Stetson\n257 SC Upstate\n213 Northwestern LA\n5 Alabama A&M\n58 Coppin St\n117 Idaho\n196 New Hampshire\n256 Savannah St\n135 Kennesaw\n7 Alcorn St\n122 Incarnate Word\n181 MS Valley St\n254 San Jose St\n312 UNC Asheville\n163 MD E Shore\n69 Delaware St\n46 Chicago St\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"constructCorrectVector(\"/home/jovyan/Data/Correct.txt\");\ncreateLabels();\ndouble sse = constructAxes();\ndouble mse = sse/64;\ndouble se = pow(mse, .5);","execution_count":5,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"#include \"xplot/xfigure.hpp\"\n#include \"xplot/xmarks.hpp\"\n#include \"xplot/xaxes.hpp\"\n#include \"xplot/xtooltip.hpp\"","execution_count":6,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"xpl::linear_scale sx, sy;\nxpl::lines line(sx, sy);\nline.x = y_axis;\nline.y = y_axis;\nauto ax_x = xpl::axis::initialize(sx)\n    .label(\"predicted\")\n    .finalize();\nauto ax_y = xpl::axis::initialize(sy)\n    .label(\"actual\")\n    .orientation(\"vertical\")\n    .side(\"left\")\n    .finalize();","execution_count":7,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"xpl::tooltip def_tt,test;\ndef_tt.fields = std::vector<xtl::xoptional<std::string>>{\"x\",\"y\"};\ndef_tt.labels = std::vector<xtl::xoptional<std::string>>{\"Predicted Ranking\",\"Actual Ranking\"};","execution_count":8,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"auto scatter1 = xpl::scatter::initialize(sx, sy)\n   .x(x_axis)\n   .y(y_axis)\n   .unhovered_style(::xeus::xjson::parse(R\"({\"opacity\": \"0.5\"})\"))\n   .tooltip(def_tt)\n   .finalize();\nscatter1.names = labels;","execution_count":9,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"auto fig1 = xpl::figure::initialize()\n    .padding_x(0.1)\n    .padding_y(0.025)\n    .finalize();\nfig1.add_mark(scatter1);\nfig1.add_axis(ax_x);\nfig1.add_axis(ax_y);\nfig1.add_mark(line);","execution_count":10,"outputs":[]},{"metadata":{},"cell_type":"markdown","source":"# Actual vs. Predicted\nThis plot displays the top 64 teams with any particular teams x value representing their predicted ranking and y value representing their actual rankikng. A team(point) close to the line represents a good/accurate prediction while teams far away from the line represent inaccurate predictions. You can hover over a point on the plot and it will tell you the actual ranking and the ranking the model predicted."},{"metadata":{"trusted":true},"cell_type":"code","source":"fig1","execution_count":11,"outputs":[{"output_type":"execute_result","execution_count":11,"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"746b30af9d6545a0bb9a65b08dd24268","version_major":2,"version_minor":0},"text/plain":"A Jupyter widget"},"metadata":{}}]},{"metadata":{},"cell_type":"markdown","source":"# Metrics"},{"metadata":{},"cell_type":"markdown","source":"## Sum of Squared Errors\nThe method used to predict the ranking of the teams uses a least squares linear regression. For any team, we want to express the margin of victory as a linear function of the teams who played that game (Massey, 1997). Each equation will have an error term, which is the actual value - the predicted value. The best model will minimize the sum of squared error terms. This is a metric we can use to determine how well our predicted points fit the curve of the actual points. The lower the SSE, the better our model does. This is the equation:\n\n$$SSE = \\sum \\limits _{i=1} ^n(y_i-\\hat{y_i})^2$$\n\nWhere y is the actual ranking and $\\hat{y}$ is the predicted ranking."},{"metadata":{"trusted":true},"cell_type":"code","source":"cout << \"SSE = \" << sse << \"\\n\" << \"With Home Field Advantage: \" << home_field_advantage\n<< \"\\n\" << \"And Margin of Victory: \" << std::boolalpha << apply_scaling << endl;","execution_count":12,"outputs":[{"output_type":"stream","text":"SSE = 17658\nWith Home Field Advantage: 0\nAnd Margin of Victory: false\n","name":"stdout"}]},{"metadata":{},"cell_type":"markdown","source":"## Mean Squared Error\nA more interpretable metric for a regression is the mean squared error. It is essentially the same as SSE, but gives us an average squared error for any point. The benefit to this is that the metric can go *down* as the number of points goes up. This is better because with SSE as you add points, the number will always go up, even if you add points that fit the model well. This is the equation for Mean Squared Errors:\n\n$$MSE = \\frac{1}{n} \\sum \\limits _{i=1} ^n(y_i-\\hat{y_i})^2$$"},{"metadata":{"trusted":true},"cell_type":"code","source":"cout << \"MSE = \" << mse << \"\\n\" << \"With Home Field Advantage: \" << home_field_advantage\n<< \"\\n\" << \"And Margin of Victory: \" << std::boolalpha << apply_scaling << endl;","execution_count":13,"outputs":[{"output_type":"stream","text":"MSE = 275.906\nWith Home Field Advantage: 0\nAnd Margin of Victory: false\n","name":"stdout"}]},{"metadata":{},"cell_type":"markdown","source":"## Standard Error\nPerhaps the most readable metric for a regression is the standard error. There are many different derivations of this equations, but the most simple one is: \n\n$$\\sigma = \\sqrt{\\frac{\\sum \\limits _{i=1} ^n(y_i-\\hat{y_i})^2}{n}}$$\n\nThis gives us the *standard deviation of the errors of predections*"},{"metadata":{"trusted":true},"cell_type":"code","source":"cout << \"SE = \" << se << \"\\n\" << \"With Home Field Advantage: \" << home_field_advantage\n<< \"\\n\" << \"And Margin of Victory: \" << std::boolalpha << apply_scaling << endl;","execution_count":14,"outputs":[{"output_type":"stream","text":"SE = 16.6104\nWith Home Field Advantage: 0\nAnd Margin of Victory: false\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"","execution_count":null,"outputs":[]}],"metadata":{"kernelspec":{"name":"xcpp14","display_name":"C++14","language":"C++14"},"language_info":{"codemirror_mode":"text/x-c++src","file_extension":".cpp","mimetype":"text/x-c++src","name":"c++","version":"14"}},"nbformat":4,"nbformat_minor":4}



